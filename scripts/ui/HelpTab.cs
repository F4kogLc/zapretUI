using ImGuiNET;

internal class HelpTab : ITab
{
    public void Render()
    {
        if (!ImGui.BeginTabItem("Help")) return;

        ImGui.PushTextWrapPos(ImGui.GetContentRegionAvail().X);
        ImGui.TextWrapped(HelpString1);
        ImGui.TextWrapped(HelpString2);
        ImGui.TextWrapped(HelpString3);
        ImGui.PopTextWrapPos();

        ImGui.EndTabItem();
    }

    const string HelpString1 = "\r\n @<config_file>|$<config_file>                  ; read file for options. must be the only argument. other options are ignored.\r\n\r\n --debug=0|1|syslog|@<filename>\r\n --version                                      ; print version and exit\r\n --dry-run                                      ; verify parameters and exit with code 0 if successful\r\n --comment=any_text\r\n --daemon                                       ; daemonize\r\n --pidfile=<filename>                           ; write pid to file\r\n --ctrack-timeouts=S:E:F[:U]                    ; internal conntrack timeouts for TCP SYN, ESTABLISHED, FIN stages, UDP timeout. default 60:300:60:60\r\n\r\nWINDIVERT FILTER:\r\n --wf-iface=<int>[.<int>]                       ; numeric network interface and subinterface indexes\r\n --wf-l3=ipv4|ipv6                              ; L3 protocol filter. multiple comma separated values allowed.\r\n --wf-tcp=[~]port1[-port2]                      ; TCP port filter. ~ means negation. multiple comma separated values allowed.\r\n --wf-udp=[~]port1[-port2]                      ; UDP port filter. ~ means negation. multiple comma separated values allowed.\r\n --wf-raw=<filter>|@<filename>                  ; raw windivert filter string or filename\r\n --wf-save=<filename>                           ; save windivert filter string to a file and exit\r\n\r\nLOGICAL NETWORK FILTER:\r\n --ssid-filter=ssid1[,ssid2,ssid3,...]          ; enable winws only if any of specified wifi SSIDs connected\r\n --nlm-filter=net1[,net2,net3,...]              ; enable winws only if any of specified NLM network is connected. names and GUIDs are accepted.\r\n --nlm-list[=all]                               ; list Network List Manager (NLM) networks. connected only or all.\r\n\r\nMULTI-STRATEGY:\r\n --new                                          ; begin new strategy\r\n --skip                                         ; do not use this strategy\r\n --filter-l3=ipv4|ipv6                          ; L3 protocol filter. multiple comma separated values allowed.\r\n --filter-tcp=[~]port1[-port2]|*                ; TCP port filter. ~ means negation. setting tcp and not setting udp filter denies udp. comma separated list allowed.\r\n --filter-udp=[~]port1[-port2]|*                ; UDP port filter. ~ means negation. setting udp and not setting tcp filter denies tcp. comma separated list allowed.\r\n --filter-l7=[http|tls|quic|wireguard|dht|discord|stun|unknown] ; L6-L7 protocol filter. multiple comma separated values allowed.\r\n --ipset=<filename>                             ; ipset include filter (one ip/CIDR per line, ipv4 and ipv6 accepted, gzip supported, multiple ipsets allowed)\r\n --ipset-ip=<ip_list>                           ; comma separated fixed subnet list\r\n --ipset-exclude=<filename>                     ; ipset exclude filter (one ip/CIDR per line, ipv4 and ipv6 accepted, gzip supported, multiple ipsets allowed)\r\n --ipset-exclude-ip=<ip_list>                   ; comma separated fixed subnet list\r\n";

    const string HelpString2 = "HOSTLIST FILTER:\r\n --hostlist=<filename>                          ; apply dpi desync only to the listed hosts (one host per line, subdomains auto apply, gzip supported, multiple hostlists allowed)\r\n --hostlist-domains=<domain_list>               ; comma separated fixed domain list\r\n --hostlist-exclude=<filename>                  ; do not apply dpi desync to the listed hosts (one host per line, subdomains auto apply, gzip supported, multiple hostlists allowed)\r\n --hostlist-exclude-domains=<domain_list>       ; comma separated fixed domain list\r\n --hostlist-auto=<filename>                     ; detect DPI blocks and build hostlist automatically\r\n --hostlist-auto-fail-threshold=<int>           ; how many failed attempts cause hostname to be added to auto hostlist (default : 3)\r\n --hostlist-auto-fail-time=<int>                ; all failed attemps must be within these seconds (default : 60)\r\n --hostlist-auto-retrans-threshold=<int>        ; how many request retransmissions cause attempt to fail (default : 3)\r\n --hostlist-auto-debug=<logfile>                ; debug auto hostlist positives\r\n\r\nTAMPER:\r\n --wsize=<window_size>[:<scale_factor>]         ; set window size. 0 = do not modify. OBSOLETE !\r\n --wssize=<window_size>[:<scale_factor>]        ; set window size for server. 0 = do not modify. default scale_factor = 0.\r\n --wssize-cutoff=[n|d|s]N                       ; apply server wsize only to packet numbers (n, default), data packet numbers (d), relative sequence (s) less than N\r\n --hostcase                                     ; change Host: => host:\r\n --hostspell                                    ; exact spelling of \"Host\" header. must be 4 chars. default is \"host\"\r\n --hostnospace                                  ; remove space after Host: and add it to User-Agent: to preserve packet size\r\n --domcase                                      ; mix domain case : Host: TeSt.cOm\r\n --methodeol                                    ; add '\\n' before method and remove space from Host:\r\n --dpi-desync=[<mode0>,]<mode>[,<mode2>]        ; try to desync dpi state. modes :\r\n                                                ; synack syndata fake fakeknown rst rstack hopbyhop destopt ipfrag1\r\n                                                ; multisplit multidisorder fakedsplit fakeddisorder ipfrag2 udplen tamper\r\n --dpi-desync-ttl=<int>                         ; set ttl for desync packet\r\n --dpi-desync-ttl6=<int>                        ; set ipv6 hop limit for desync packet. by default ttl value is used.\r\n --dpi-desync-autottl=[<delta>[:<min>[-<max>]]] ; auto ttl mode for both ipv4 and ipv6. default: 1:3-20\r\n --dpi-desync-autottl6=[<delta>[:<min>[-<max>]]] ; overrides --dpi-desync-autottl for ipv6 only\r\n --dpi-desync-fooling=<mode>[,<mode>]           ; can use multiple comma separated values. modes : none md5sig ts badseq badsum datanoack hopbyhop hopbyhop2\r\n --dpi-desync-repeats=<N>                       ; send every desync packet N times\r\n --dpi-desync-skip-nosni=0|1                    ; 1(default)=do not act on ClientHello without SNI\r\n";

    const string HelpString3 = "--dpi-desync-split-pos=N|-N|marker+N|marker-N  ; comma separated list of split positions\r\n                                                ; markers: method,host,endhost,sld,endsld,midsld,sniext\r\n                                                ; full list is only used by multisplit and multidisorder\r\n                                                ; fakedsplit/fakeddisorder use first l7-protocol-compatible parameter if present, first abs value otherwise\r\n --dpi-desync-split-seqovl=N|-N|marker+N|marker-N ; use sequence overlap before first sent original split segment\r\n --dpi-desync-split-seqovl-pattern=<filename>|0xHEX ; pattern for the fake part of overlap\r\n --dpi-desync-fakedsplit-pattern=<filename>|0xHEX ; fake pattern for fakedsplit/fakeddisorder\r\n --dpi-desync-ipfrag-pos-tcp=<8..9216>          ; ip frag position starting from the transport header. multiple of 8, default 8.\r\n --dpi-desync-ipfrag-pos-udp=<8..9216>          ; ip frag position starting from the transport header. multiple of 8, default 32.\r\n --dpi-desync-badseq-increment=<int|0xHEX>      ; badseq fooling seq signed increment. default -10000\r\n --dpi-desync-badack-increment=<int|0xHEX>      ; badseq fooling ackseq signed increment. default -66000\r\n --dpi-desync-any-protocol=0|1                  ; 0(default)=desync only http and tls  1=desync any nonempty data packet --dpi-desync-fake-http=<filename>|0xHEX        ; file containing fake http request\r\n --dpi-desync-fake-tls=<filename>|0xHEX         ; file containing fake TLS ClientHello (for https)\r\n --dpi-desync-fake-tls-mod=mod[,mod]            ; comma separated list of TLS fake mods. available mods : none,rnd,rndsni,sni=<sni>,dupsid,padencap\r\n --dpi-desync-fake-unknown=<filename>|0xHEX     ; file containing unknown protocol fake payload\r\n --dpi-desync-fake-syndata=<filename>|0xHEX     ; file containing SYN data payload\r\n --dpi-desync-fake-quic=<filename>|0xHEX        ; file containing fake QUIC Initial\r\n --dpi-desync-fake-wireguard=<filename>|0xHEX   ; file containing fake wireguard handshake initiation\r\n --dpi-desync-fake-dht=<filename>|0xHEX         ; file containing DHT protocol fake payload (d1...e)\r\n --dpi-desync-fake-discord=<filename>|0xHEX     ; file containing discord protocol fake payload (Voice IP Discovery)\r\n --dpi-desync-fake-stun=<filename>|0xHEX        ; file containing STUN protocol fake payload\r\n --dpi-desync-fake-unknown-udp=<filename>|0xHEX ; file containing unknown udp protocol fake payload\r\n --dpi-desync-udplen-increment=<int>            ; increase or decrease udp packet length by N bytes (default 2). negative values decrease length.\r\n --dpi-desync-udplen-pattern=<filename>|0xHEX   ; udp tail fill pattern\r\n --dpi-desync-start=[n|d|s]N                    ; apply dpi desync only to packet numbers (n, default), data packet numbers (d), relative sequence (s) greater or equal than N\r\n --dpi-desync-cutoff=[n|d|s]N                   ; apply dpi desync only to packet numbers (n, default), data packet numbers (d), relative sequence (s) less than N";
}
